<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Safe Trade Hub — Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0a0f1c;
      --panel:#ffffff;
      --text:#0f172a;
      --muted:#6b7280;
      --brand1:#06b6d4;   /* cyan */
      --brand2:#22c55e;   /* emerald */
      --accent:#7c3aed;   /* violet */
      --chip:#e6f9f4;
      --radius:18px;
      --shadow:0 12px 30px rgba(2,6,23,.18);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
      background:
        radial-gradient(900px 600px at -10% 0%, rgba(124,58,237,.18), transparent 55%),
        radial-gradient(900px 600px at 110% 10%, rgba(34,197,94,.18), transparent 55%),
        var(--bg);
      display:flex; align-items:center; justify-content:center;
      color:var(--text);
    }

    /* Phone-like shell */
    .phone {
      width: 380px; max-width: 92vw; height: 680px; max-height: 92vh;
      background: var(--panel);
      border-radius: 26px;
      box-shadow: var(--shadow);
      display:flex; flex-direction:column; overflow:hidden; position:relative;
    }

    /* Header */
    .chat-header{
      padding: 16px 18px;
      color:#fff;
      font-weight:700;
      letter-spacing:.3px;
      display:flex; align-items:center; justify-content:space-between;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      border-bottom: 1px solid rgba(255,255,255,.15);
    }
    .header-left{display:flex; align-items:center; gap:10px}
    .online-dot{
      width:10px; height:10px; border-radius:999px; background:#fff; opacity:.95;
      box-shadow:0 0 0 4px rgba(255,255,255,.22);
    }
    .icon-btn{
      background: rgba(255,255,255,.18);
      border:0; color:#fff; width:34px; height:34px; border-radius:12px;
      display:grid; place-items:center; cursor:pointer;
    }

    /* Messages area */
    .messages{
      flex:1; overflow-y:auto; padding:16px 14px 12px;
      background: linear-gradient(180deg, rgba(2,6,23,.03), transparent 18%) no-repeat #f6f9fe;
    }
    .msg{
      max-width:76%; margin:10px 0; padding:10px 12px; border-radius:16px;
      line-height:1.35; font-size:14px; position:relative;
      box-shadow: 0 2px 8px rgba(2,6,23,.06);
    }
    .msg.bot{
      background:#ffffff; border:1px solid rgba(15,23,42,.08);
      border-top-right-radius:6px;
      margin-right:auto;
    }
    .msg.user{
      background: linear-gradient(135deg, var(--brand1), var(--accent));
      color:#fff; border-top-left-radius:6px;
      margin-left:auto;
    }
    .meta{
      margin-top:6px; font-size:11px; color:var(--muted);
      opacity:.9; display:block;
    }

    /* Quick reply chips */
    .chips{
      display:flex; flex-wrap:wrap; gap:10px; padding:10px 14px 2px;
      background: #f6f9fe;
    }
    .chip{
      padding:8px 12px; border-radius:999px; font-size:13px; cursor:pointer;
      background: var(--chip); color:#047857; border:1px solid #a7f3d0;
      transition: transform .06s ease, filter .2s ease;
      user-select:none;
    }
    .chip:hover{ filter:brightness(1.03) }
    .chip:active{ transform: translateY(1px) }

    /* Input dock */
    .dock{
      background:#fff; border-top:1px solid rgba(15,23,42,.06);
      padding:10px 12px; display:flex; align-items:center; gap:10px;
      position:relative;
    }
    #user-input{
      flex:1; height:46px; border-radius:999px; border:1px solid rgba(2,6,23,.12);
      padding:0 14px; font-size:14px; outline:none;
      background: #eef5ff;
    }
    #user-input:focus{
      box-shadow:0 0 0 3px rgba(34,197,94,.18);
      border-color:transparent; background:#fff;
    }
    #sendBtn{
      height:46px; padding:0 22px; border:0; border-radius:16px;
      color:#fff; font-weight:700; cursor:pointer;
      background: linear-gradient(135deg, var(--accent), var(--brand1));
      box-shadow: 0 10px 22px rgba(6,182,212,.38);
      transition: transform .06s ease, filter .25s ease;
    }
    #sendBtn:hover{ filter:brightness(1.05) }
    #sendBtn:active{ transform: translateY(1px) scale(.99) }
    #sendBtn:disabled{
      cursor:not-allowed; opacity:.55; box-shadow:none;
      background: linear-gradient(135deg, #d8d8e7, #d9eef6);
    }

    /* small */
    @media (max-width:420px){
      .phone{ height: 90vh; }
    }
  </style>
</head>
<body>

  <main class="phone" role="main" aria-label="Chat widget">
    <header class="chat-header">
      <div class="header-left">
        <span class="online-dot" aria-hidden="true"></span>
        <div>Safe Trade Hub — Chat</div>
      </div>
      <button class="icon-btn" aria-label="Help" title="Help">
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M12 2a10 10 0 100 20 10 10 0 000-20Zm0 14.5a1.25 1.25 0 110 2.5 1.25 1.25 0 010-2.5Zm1.35-8.9c1.25.43 2.15 1.5 2.15 2.9 0 1.9-1.38 2.65-2.03 3.05-.54.33-.72.53-.72 1.1v.35h-1.9v-.5c0-1.44.62-2.07 1.4-2.55.6-.37 1.35-.83 1.35-1.8 0-.8-.6-1.4-1.45-1.4-.87 0-1.5.52-1.67 1.4l-1.9-.35C7.85 7 9.23 5.8 11 5.6c.73-.08 1.45.02 2.35.5Z"/></svg>
      </button>
    </header>

    <section class="messages" id="chatlogs" aria-live="polite">
      <div class="msg bot">
        Hello! I’m your assistant. How can I help you today?
        <span class="meta">just now</span>
      </div>
    </section>

    <div class="chips" id="chips">
      <div class="chip">How do I create an account?</div>
      <div class="chip">Fees & payments</div>
      <div class="chip">Delivery time</div>
      <div class="chip">Report a seller</div>
      <div class="chip">Contact support</div>
    </div>

    <div class="dock">
      <input id="user-input" placeholder="Type your message…" autocomplete="off" />
      <button id="sendBtn" type="button">Send</button>
    </div>
  </main>

  <script>
    // Elements
    const logs = document.getElementById('chatlogs');
    const input = document.getElementById('user-input');
    const sendBtn = document.getElementById('sendBtn');
    const chipsWrap = document.getElementById('chips');
  
    // Helpers
    const fmtTime = () => new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    const addMsg = (text, who='bot') => {
      const div = document.createElement('div');
      div.className = `msg ${who}`;
      div.textContent = text;
      const meta = document.createElement('span');
      meta.className = 'meta';
      meta.textContent = fmtTime();
      div.appendChild(meta);
      logs.appendChild(div);
      logs.scrollTop = logs.scrollHeight;
    };
  
    // Enable/disable send
    const toggle = () => sendBtn.disabled = input.value.trim() === '';
    input.addEventListener('input', toggle);
    toggle();
  
    // Quick reply chips
    chipsWrap.addEventListener('click', (e) => {
      const chip = e.target.closest('.chip');
      if (!chip) return;
      input.value = chip.textContent.trim();
      toggle();
      input.focus();
    });
  
    // Send handlers
    sendBtn.addEventListener('click', sendMessage);
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !sendBtn.disabled) sendMessage();
    });
  
    async function sendMessage(){
      const text = input.value.trim();
      if (!text) return;
  
      addMsg(text, 'user');
      input.value = '';
      toggle();
  
      try {
        const res = await fetch('https://safetradehub-d797d24354d2.herokuapp.com/chat', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ message: text })
        });
        const data = await res.json();
        addMsg(data?.response ?? 'Sorry, I could not process that.');
      } catch (err) {
        console.error(err);
        addMsg('Network error — please try again.');
      }
    }
  </script>
  
</body>
</html>
