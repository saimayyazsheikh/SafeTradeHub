<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Results - SafeTradeHub</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">SafeTradeHub</a>
                </div>
                
                <!-- Search Bar -->
                <div class="search-bar">
                    <form id="searchForm" class="search-form">
                        <input type="text" id="searchInput" placeholder="Search for products..." class="search-input">
                        <button type="submit" class="search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>
                
                <div class="header-actions">
                    <a href="cart.html" class="cart-link">
                        <i class="fas fa-shopping-cart"></i>
                        <span id="cartCount" class="cart-count">0</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Search Results Header -->
            <div class="search-results-header">
                <h2 id="searchTitle">Search Results</h2>
                <div class="search-results-stats" id="resultsCount">0 products found</div>
            </div>

            <!-- Search Results Grid -->
            <div class="search-results-grid" id="searchResultsGrid">
                <!-- Results will be populated here -->
            </div>

            <!-- Empty State -->
            <div class="search-empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">üîç</div>
                <h3>No products found</h3>
                <p>Try adjusting your search terms or browse our categories</p>
                <a href="index.html" class="btn btn-primary">Browse Categories</a>
            </div>
        </div>
    </main>

    <script>
    // Sample products data
    const sampleProducts = [
      {
        id: 'sample-1',
        name: 'iPhone 12 Pro Max',
        category: 'mobile',
        price: 899,
        condition: 'new',
        description: 'Latest iPhone with advanced camera system',
        brand: 'Apple',
        location: 'Karachi',
        images: ['images/iphone12.jpg'],
        rating: 4.8
      },
      {
        id: 'sample-2',
        name: 'Samsung Galaxy S21',
        category: 'mobile',
        price: 699,
        condition: 'new',
        description: 'Powerful Android smartphone with great camera',
        brand: 'Samsung',
        location: 'Lahore',
        images: ['images/samsung.jpg'],
        rating: 4.6
      },
      {
        id: 'sample-3',
        name: 'Canon EOS R5',
        category: 'camera',
        price: 2499,
        condition: 'new',
        description: 'Professional mirrorless camera',
        brand: 'Canon',
        location: 'Islamabad',
        images: ['images/camera.jpg'],
        rating: 4.9
      },
      {
        id: 'sample-4',
        name: 'MacBook Pro M1',
        category: 'computers',
        price: 1299,
        condition: 'new',
        description: 'Powerful laptop for professionals',
        brand: 'Apple',
        location: 'Karachi',
        images: ['images/laptop.jpg'],
        rating: 4.7
      },
      {
        id: 'sample-5',
        name: 'Designer Dress',
        category: 'fashion',
        price: 199,
        condition: 'new',
        description: 'Elegant evening dress',
        brand: 'Fashion Brand',
        location: 'Lahore',
        images: ['images/dress.jpg'],
        rating: 4.5
      },
      {
        id: 'sample-6',
        name: 'Mobile Accessories',
        category: 'mobile',
        price: 49,
        condition: 'new',
        description: 'Essential mobile phone accessories',
        brand: 'Generic',
        location: 'Karachi',
        images: ['images/iphone12.jpg'],
        rating: 4.3
      },
      {
        id: 'sample-7',
        name: 'Wireless Headphones',
        category: 'mobile',
        price: 99,
        condition: 'new',
        description: 'High-quality wireless headphones',
        brand: 'Sony',
        location: 'Lahore',
        images: ['images/headphones.jpg'],
        rating: 4.4
      },
      {
        id: 'sample-8',
        name: 'Gaming Laptop',
        category: 'computers',
        price: 1599,
        condition: 'new',
        description: 'High-performance gaming laptop',
        brand: 'ASUS',
        location: 'Islamabad',
        images: ['images/laptop.jpg'],
        rating: 4.6
      },
      {
        id: 'sample-9',
        name: 'Nikon D850',
        category: 'camera',
        price: 1999,
        condition: 'new',
        description: 'Professional DSLR camera',
        brand: 'Nikon',
        location: 'Karachi',
        images: ['images/camera.jpg'],
        rating: 4.8
      },
      {
        id: 'sample-10',
        name: 'Designer Handbag',
        category: 'fashion',
        price: 299,
        condition: 'new',
        description: 'Luxury designer handbag',
        brand: 'Luxury Brand',
        location: 'Lahore',
        images: ['images/dress.jpg'],
        rating: 4.7
      },
      {
        id: 'sample-11',
        name: 'iPhone 13',
        category: 'mobile',
        price: 999,
        condition: 'new',
        description: 'Latest iPhone with advanced features',
        brand: 'Apple',
        location: 'Karachi',
        images: ['images/iphone12.jpg'],
        rating: 4.9
      },
      {
        id: 'sample-12',
        name: 'Samsung Galaxy S22',
        category: 'mobile',
        price: 799,
        condition: 'new',
        description: 'Latest Samsung flagship smartphone',
        brand: 'Samsung',
        location: 'Lahore',
        images: ['images/samsung.jpg'],
        rating: 4.8
      },
      {
        id: 'sample-13',
        name: 'MacBook Air M2',
        category: 'computers',
        price: 1199,
        condition: 'new',
        description: 'Ultra-thin laptop with M2 chip',
        brand: 'Apple',
        location: 'Islamabad',
        images: ['images/laptop.jpg'],
        rating: 4.9
      },
      {
        id: 'sample-14',
        name: 'Sony A7R IV',
        category: 'camera',
        price: 2999,
        condition: 'new',
        description: 'Professional mirrorless camera with 61MP sensor',
        brand: 'Sony',
        location: 'Karachi',
        images: ['images/camera.jpg'],
        rating: 4.8
      },
      {
        id: 'sample-15',
        name: 'iPhone 12',
        category: 'mobile',
        price: 799,
        condition: 'new',
        description: 'Apple iPhone 12 with A14 Bionic chip',
        brand: 'Apple',
        location: 'Lahore',
        images: ['images/iphone12.jpg'],
        rating: 4.7
      },
      {
        id: 'sample-16',
        name: 'Dell XPS 13',
        category: 'computers',
        price: 1099,
        condition: 'new',
        description: 'Ultrabook with 13-inch display',
        brand: 'Dell',
        location: 'Islamabad',
        images: ['images/laptop.jpg'],
        rating: 4.6
      },
      {
        id: 'sample-17',
        name: 'Fujifilm X-T4',
        category: 'camera',
        price: 1699,
        condition: 'new',
        description: 'Mirrorless camera with 26.1MP sensor',
        brand: 'Fujifilm',
        location: 'Karachi',
        images: ['images/camera.jpg'],
        rating: 4.7
      },
      {
        id: 'sample-18',
        name: 'Samsung Galaxy Note 20',
        category: 'mobile',
        price: 899,
        condition: 'new',
        description: 'Samsung flagship with S Pen',
        brand: 'Samsung',
        location: 'Lahore',
        images: ['images/samsung.jpg'],
        rating: 4.5
      },
      {
        id: 'sample-19',
        name: 'HP Pavilion',
        category: 'computers',
        price: 699,
        condition: 'new',
        description: 'Budget-friendly laptop for everyday use',
        brand: 'HP',
        location: 'Islamabad',
        images: ['images/laptop.jpg'],
        rating: 4.3
      },
      {
        id: 'sample-20',
        name: 'Panasonic Lumix GH5',
        category: 'camera',
        price: 1299,
        condition: 'new',
        description: '4K video camera for content creators',
        brand: 'Panasonic',
        location: 'Karachi',
        images: ['images/camera.jpg'],
        rating: 4.6
      }
    ];

    let searchResults = [];

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Get search term from URL
      const urlParams = new URLSearchParams(window.location.search);
      const searchTerm = urlParams.get('q');
      
      if (searchTerm) {
        document.getElementById('searchInput').value = searchTerm;
        performSearch(searchTerm);
      }
      
      // Setup search form
      document.getElementById('searchForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const term = document.getElementById('searchInput').value.trim();
        if (term) {
          performSearch(term);
        }
      });
      
      // Update cart count
      updateCartCount();
    });

    // Perform search
    function performSearch(searchTerm) {
      const term = searchTerm.toLowerCase().trim();
      
      if (!term) {
        searchResults = [];
        updateSearchTitle('');
        updateResultsCount();
        renderResults();
        return;
      }
      
      // Comprehensive search - check all fields
      searchResults = sampleProducts.filter(product => {
        const name = product.name.toLowerCase();
        const description = product.description.toLowerCase();
        const category = product.category.toLowerCase();
        const brand = product.brand ? product.brand.toLowerCase() : '';
        const location = product.location ? product.location.toLowerCase() : '';
        
        // Split search term into words for better matching
        const searchWords = term.split(/\s+/).filter(word => word.length > 0);
        
        // Check if any search word matches any field
        const matches = searchWords.some(word => 
          name.includes(word) || 
          description.includes(word) || 
          category.includes(word) || 
          brand.includes(word) ||
          location.includes(word)
        );
        
        return matches;
      });
      
      // Sort results by relevance (exact matches first)
      searchResults.sort((a, b) => {
        const aName = a.name.toLowerCase();
        const bName = b.name.toLowerCase();
        const aCategory = a.category.toLowerCase();
        const bCategory = b.category.toLowerCase();
        const aBrand = a.brand ? a.brand.toLowerCase() : '';
        const bBrand = b.brand ? b.brand.toLowerCase() : '';
        
        // Calculate relevance scores
        const getRelevanceScore = (product) => {
          let score = 0;
          const name = product.name.toLowerCase();
          const category = product.category.toLowerCase();
          const brand = product.brand ? product.brand.toLowerCase() : '';
          const description = product.description.toLowerCase();
          
          // Exact matches get highest scores
          if (name === term) score += 1000;
          if (category === term) score += 800;
          if (brand === term) score += 600;
          
          // Starts with gets high scores
          if (name.startsWith(term)) score += 500;
          if (category.startsWith(term)) score += 400;
          if (brand.startsWith(term)) score += 300;
          
          // Contains gets medium scores
          if (name.includes(term)) score += 200;
          if (category.includes(term)) score += 150;
          if (brand.includes(term)) score += 100;
          if (description.includes(term)) score += 50;
          
          return score;
        };
        
        const scoreA = getRelevanceScore(a);
        const scoreB = getRelevanceScore(b);
        
        // Sort by relevance score (highest first)
        if (scoreA !== scoreB) {
          return scoreB - scoreA;
        }
        
        // If scores are equal, sort by name alphabetically
        return aName.localeCompare(bName);
      });
      
      updateSearchTitle(searchTerm);
      updateResultsCount();
      renderResults();
    }

    // Update search title
    function updateSearchTitle(searchTerm) {
      document.getElementById('searchTitle').textContent = `Search Results for "${searchTerm}"`;
    }

    // Update results count
    function updateResultsCount() {
      const count = searchResults.length;
      document.getElementById('resultsCount').textContent = `${count} product${count !== 1 ? 's' : ''} found`;
    }

    // Render search results
    function renderResults() {
      const grid = document.getElementById('searchResultsGrid');
      const emptyState = document.getElementById('emptyState');
      
      if (searchResults.length === 0) {
        grid.style.display = 'none';
        emptyState.style.display = 'block';
        return;
      }
      
      grid.style.display = 'grid';
      emptyState.style.display = 'none';
      
      grid.innerHTML = searchResults.map(product => `
        <article class="card" data-product-id="${product.id}">
          <div class="card-img">
            <img src="${product.images?.[0] || 'images/mobile.jpg'}" alt="${product.name}" loading="lazy">
            ${product.price > 500 ? '<div class="card-badge">Premium</div>' : ''}
          </div>
          <div class="card-content">
            <h3 class="card-title">${product.name}</h3>
            <p class="card-description">${product.description}</p>
            <div class="card-price">$${product.price.toFixed(2)}</div>
            <div class="card-actions">
              <button class="card-btn card-btn-primary" 
                      data-add-to-cart
                      data-id="${product.id}"
                      data-name="${product.name}"
                      data-price="${product.price.toFixed(2)}"
                      data-img="${product.images?.[0] || 'images/mobile.jpg'}"
                      data-desc="${product.description}">
                Add to Cart
              </button>
              <button class="card-btn card-btn-secondary" onclick="viewProduct('${product.id}')">
                View Details
              </button>
            </div>
          </div>
        </article>
      `).join('');
    }

    // View product details
    function viewProduct(productId) {
      const product = searchResults.find(p => p.id === productId);
      if (product) {
        // Navigate to appropriate category page
        window.location.href = `category-${product.category}.html#product-${productId}`;
      }
    }

    // Update cart count
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('CART_KEY') || '[]');
      document.getElementById('cartCount').textContent = cart.length;
    }
    </script>

    <style>
    /* Search Results Page Styles */
    .search-results-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid #e5e7eb;
    }

    .search-results-header h2 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
      color: #374151;
    }

    .search-results-stats {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .search-results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
    }

    /* Card Styles to match category pages */
    .card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(16, 24, 40, 0.08), 0 1px 3px rgba(16, 24, 40, 0.10);
      overflow: hidden;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(16, 24, 40, 0.12), 0 4px 12px rgba(16, 24, 40, 0.08);
      border-color: #d1d9ff;
    }

    .card-img {
      position: relative;
      height: 200px;
      overflow: hidden;
    }

    .card-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .card:hover .card-img img {
      transform: scale(1.05);
    }

    .card-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #ff6b6b;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .card-content {
      padding: 20px;
    }

    .card-title {
      margin: 0 0 8px 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: #1f2937;
      transition: color 0.3s ease;
    }

    .card:hover .card-title {
      color: #3b82f6;
    }

    .card-description {
      margin: 0 0 12px 0;
      font-size: 0.875rem;
      color: #6b7280;
      line-height: 1.4;
    }

    .card-price {
      font-size: 1.25rem;
      font-weight: 700;
      color: #059669;
      margin-bottom: 16px;
      transition: color 0.3s ease;
    }

    .card:hover .card-price {
      color: #047857;
    }

    .card-actions {
      display: flex;
      gap: 8px;
    }

    .card-btn {
      flex: 1;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .card-btn-primary {
      background: #3b82f6;
      color: white;
    }

    .card-btn-primary:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }

    .card-btn-secondary {
      background: white;
      color: #374151;
      border: 1px solid #e5e7eb;
    }

    .card-btn-secondary:hover {
      background: #f8fafc;
      border-color: #d1d5db;
    }

    .search-empty-state {
      text-align: center;
      padding: 48px 24px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(16, 24, 40, 0.06);
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 16px;
    }

    .search-empty-state h3 {
      margin: 0 0 8px 0;
      font-size: 1.5rem;
      color: #374151;
    }

    .search-empty-state p {
      margin: 0 0 24px 0;
      color: #6b7280;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .search-results-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .search-results-grid {
        grid-template-columns: 1fr;
      }
      
      .card-actions {
        flex-direction: column;
      }
    }
    </style>
</body>
</html>
