<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>STH â€“ Admin</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-functions.js"></script>
</head>
<body class="page-admin">
<header class="site-header">
  <div class="container header-inner">
    <a href="index.html" class="logo">SafeTradeHub</a>
    <nav class="header-actions">
      <span id="me" class="link"></span>
    </nav>
  </div>
</header>

<section class="section">
  <div class="container" style="max-width:1400px">
    <div class="admin-header">
      <h1>Admin Dashboard</h1>
      <div class="admin-stats">
        <div class="stat-item">
          <div class="stat-value" id="totalUsers">0</div>
          <div class="stat-label">Total Users</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="pendingVerifications">0</div>
          <div class="stat-label">Pending Verifications</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="verifiedUsers">0</div>
          <div class="stat-label">Verified Users</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="sellers">0</div>
          <div class="stat-label">Sellers</div>
        </div>
      </div>
    </div>

    <!-- Admin Actions -->
    <div class="admin-actions">
      <div class="action-card">
        <h3>User Management</h3>
        <div class="form-row">
        <input id="newAdminEmail" type="email" placeholder="Promote user to admin by email"/>
          <button class="btn primary" id="promoteBtn">Promote to Admin</button>
        </div>
        <div class="form-row">
          <input id="suspendEmail" type="email" placeholder="Suspend user by email"/>
          <button class="btn danger" id="suspendBtn">Suspend User</button>
        </div>
      </div>

      <div class="action-card">
        <h3>Bulk Actions</h3>
        <div class="bulk-actions">
          <button class="btn secondary" id="exportUsersBtn">Export Users</button>
          <button class="btn secondary" id="sendNotificationBtn">Send Notification</button>
          <button class="btn secondary" id="refreshDataBtn">Refresh Data</button>
        </div>
      </div>
    </div>

    <!-- Filters and Search -->
    <div class="filters-card">
      <div class="filters-row">
        <div class="filter-group">
          <label>Filter by Status</label>
          <select id="filterStatus">
            <option value="all">All Users</option>
            <option value="pending">Pending Verification</option>
            <option value="verified">Verified</option>
            <option value="suspended">Suspended</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Filter by Role</label>
          <select id="filterRole">
            <option value="all">All Roles</option>
            <option value="buyer">Buyers</option>
            <option value="seller">Sellers</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Filter by Verification Step</label>
        <select id="filterStep">
            <option value="all">All Steps</option>
            <option value="email">Email Pending</option>
            <option value="phone">Phone Pending</option>
            <option value="address">Address Pending</option>
            <option value="cnic">CNIC Pending</option>
            <option value="selfie">Selfie Pending</option>
            <option value="shop">Shop Pending</option>
        </select>
        </div>
        <div class="filter-group">
          <label>Search</label>
          <input id="searchInput" type="search" placeholder="Search by email, name, or ID"/>
        </div>
      </div>
    </div>

    <!-- Users Table -->
    <div class="users-table-card">
      <div class="table-header">
        <h3>User Verification Queue</h3>
        <div class="table-actions">
          <button class="btn secondary" id="selectAllBtn">Select All</button>
          <button class="btn primary" id="bulkApproveBtn" disabled>Bulk Approve</button>
          <button class="btn danger" id="bulkRejectBtn" disabled>Bulk Reject</button>
        </div>
      </div>
      <div class="table-container">
        <table class="users-table">
          <thead>
            <tr>
              <th><input type="checkbox" id="selectAllCheckbox"></th>
              <th>User</th>
              <th>Role</th>
              <th>Status</th>
              <th>Verification Progress</th>
              <th>Documents</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="usersTableBody">
            <tr>
              <td colspan="7" class="loading-row">
                <div class="loading-skeleton">
                  <div class="skeleton-line"></div>
                  <div class="skeleton-line"></div>
                  <div class="skeleton-line"></div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      </div>

    <!-- Verification Details Modal -->
    <div id="verificationModal" class="modal">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <h3>Verification Details</h3>
          <button class="close-btn" id="closeVerificationModal">Ã—</button>
        </div>
        <div class="modal-content" id="verificationContent">
          <!-- Content will be populated dynamically -->
        </div>
      </div>
    </div>
  </div>
</section>

<footer class="site-footer"><div class="container"><p>All Rights Reserved By Safe Trade Hub</p></div></footer>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBK-1VZZImDnjmRCXBEzyLAq6AthTZ8yIs",
  authDomain: "safe-trade-hub-a57cb.firebaseapp.com",
  projectId: "safe-trade-hub-a57cb",
  storageBucket: "safe-trade-hub-a57cb.appspot.com",
  messagingSenderId: "509522351934",
  appId: "1:509522351934:web:a9f5624cded8f7a6d93e6f",
  measurementId: "G-060FYYP5DD"
};
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db   = firebase.firestore();
const fns  = firebase.functions();

const $ = (id)=> document.getElementById(id);
let isAdmin = false;
let allUsers = [];
let filteredUsers = [];
let selectedUsers = new Set();

auth.onAuthStateChanged(async u=>{
  if(!u){ location.href = 'auth.html?mode=signin'; return; }
  $('me').textContent = u.email || u.uid;
  const token = await u.getIdTokenResult(true);
  isAdmin = token.claims && token.claims.role === 'admin';
  if(!isAdmin){ alert('Admin only.'); location.href = 'index.html'; return; }
  await loadUsers();
  loadStats();
});

async function loadUsers(){
  try {
    const snap = await db.collection('users').orderBy('createdAt','desc').get();
    allUsers = [];
    snap.forEach(doc => {
      const user = doc.data();
      allUsers.push({
        id: doc.id,
        ...user,
        createdAt: user.createdAt?.toDate?.() || new Date(),
        lastLoginAt: user.lastLoginAt?.toDate?.() || new Date()
      });
    });
    
    filteredUsers = [...allUsers];
    renderUsers();
  } catch (error) {
    console.error('Error loading users:', error);
    showError('Failed to load users. Please try again.');
  }
}

function loadStats() {
  const totalUsers = allUsers.length;
  const pendingVerifications = allUsers.filter(u => u.status === 'pending').length;
  const verifiedUsers = allUsers.filter(u => u.status === 'verified').length;
  const sellers = allUsers.filter(u => u.role === 'Seller').length;
  
  $('totalUsers').textContent = totalUsers;
  $('pendingVerifications').textContent = pendingVerifications;
  $('verifiedUsers').textContent = verifiedUsers;
  $('sellers').textContent = sellers;
}

function renderUsers(){
  const tbody = $('usersTableBody');
  
  if (filteredUsers.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="7" class="empty-row">
          <div class="empty-state">
            <div class="empty-icon">ðŸ‘¥</div>
            <div class="empty-text">No users found</div>
          </div>
        </td>
      </tr>
    `;
    return;
  }

  tbody.innerHTML = filteredUsers.map(user => {
    const verification = user.verification || {};
    const progress = calculateVerificationProgress(verification, user.role);
    const status = getUserStatus(user);
    const documents = getDocumentLinks(verification);
    
    return `
      <tr data-user-id="${user.id}">
        <td>
          <input type="checkbox" class="user-checkbox" value="${user.id}">
        </td>
        <td>
          <div class="user-info">
            <div class="user-name">${user.displayName || 'Unknown'}</div>
            <div class="user-email">${user.email || user.id}</div>
            <div class="user-joined">Joined ${user.createdAt.toLocaleDateString()}</div>
          </div>
        </td>
        <td>
          <span class="role-badge ${user.role?.toLowerCase() || 'buyer'}">${user.role || 'Buyer'}</span>
        </td>
        <td>
          <span class="status-badge ${status.toLowerCase()}">${status}</span>
        </td>
        <td>
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${progress}%"></div>
            <span class="progress-text">${progress}%</span>
          </div>
          <div class="progress-steps">
            ${getProgressSteps(verification, user.role)}
          </div>
        </td>
        <td>
          <div class="document-links">
            ${documents.length > 0 ? documents.join('') : '<span class="no-docs">No documents</span>'}
          </div>
        </td>
        <td>
          <div class="action-buttons">
            <button class="btn small primary" onclick="viewVerification('${user.id}')">View</button>
            <button class="btn small success" onclick="approveUser('${user.id}')">Approve</button>
            <button class="btn small danger" onclick="rejectUser('${user.id}')">Reject</button>
          </div>
        </td>
      </tr>
    `;
  }).join('');
}

function calculateVerificationProgress(verification, role) {
  const steps = ['email', 'phone', 'address', 'cnic', 'selfie'];
  if (role === 'Seller') steps.push('shop');
  
  const completedSteps = steps.filter(step => {
    if (step === 'email') return verification.email;
    if (step === 'phone') return verification.phone;
    if (step === 'address') return verification.address?.verified;
    if (step === 'cnic') return verification.cnic?.verified;
    if (step === 'selfie') return verification.selfie?.verified;
    if (step === 'shop') return verification.shop?.verified;
    return false;
  }).length;
  
  return Math.round((completedSteps / steps.length) * 100);
}

function getUserStatus(user) {
  if (user.isSuspended) return 'Suspended';
  if (user.status === 'verified') return 'Verified';
  if (user.status === 'pending') return 'Pending';
  return 'Inactive';
}

function getDocumentLinks(verification) {
  const links = [];
  
  if (verification.cnic?.frontUrl) {
    links.push(`<a href="${verification.cnic.frontUrl}" target="_blank" class="doc-link">CNIC Front</a>`);
  }
  if (verification.cnic?.backUrl) {
    links.push(`<a href="${verification.cnic.backUrl}" target="_blank" class="doc-link">CNIC Back</a>`);
  }
  if (verification.selfie?.url) {
    links.push(`<a href="${verification.selfie.url}" target="_blank" class="doc-link">Selfie</a>`);
  }
  if (verification.shop?.photoUrls?.length > 0) {
    verification.shop.photoUrls.forEach((url, i) => {
      links.push(`<a href="${url}" target="_blank" class="doc-link">Shop Photo ${i + 1}</a>`);
    });
  }
  if (verification.shop?.docUrls?.length > 0) {
    verification.shop.docUrls.forEach((url, i) => {
      links.push(`<a href="${url}" target="_blank" class="doc-link">Shop Doc ${i + 1}</a>`);
    });
  }
  
  return links;
}

function getProgressSteps(verification, role) {
  const steps = [
    { key: 'email', label: 'Email', verified: verification.email },
    { key: 'phone', label: 'Phone', verified: verification.phone },
    { key: 'address', label: 'Address', verified: verification.address?.verified },
    { key: 'cnic', label: 'CNIC', verified: verification.cnic?.verified },
    { key: 'selfie', label: 'Selfie', verified: verification.selfie?.verified }
  ];
  
  if (role === 'Seller') {
    steps.push({ key: 'shop', label: 'Shop', verified: verification.shop?.verified });
  }
  
  return steps.map(step => `
    <span class="progress-step ${step.verified ? 'completed' : 'pending'}">
      ${step.verified ? 'âœ“' : 'â—‹'} ${step.label}
    </span>
  `).join('');
}

// Filter and search functionality
$('filterStatus').addEventListener('change', applyFilters);
$('filterRole').addEventListener('change', applyFilters);
$('filterStep').addEventListener('change', applyFilters);
$('searchInput').addEventListener('input', applyFilters);

function applyFilters() {
  const statusFilter = $('filterStatus').value;
  const roleFilter = $('filterRole').value;
  const stepFilter = $('filterStep').value;
  const searchTerm = $('searchInput').value.trim().toLowerCase();
  
  filteredUsers = allUsers.filter(user => {
    // Status filter
    if (statusFilter !== 'all') {
      if (statusFilter === 'pending' && user.status !== 'pending') return false;
      if (statusFilter === 'verified' && user.status !== 'verified') return false;
      if (statusFilter === 'suspended' && !user.isSuspended) return false;
    }
    
    // Role filter
    if (roleFilter !== 'all') {
      if (roleFilter === 'buyer' && user.role !== 'Buyer') return false;
      if (roleFilter === 'seller' && user.role !== 'Seller') return false;
    }
    
    // Step filter
    if (stepFilter !== 'all') {
      const verification = user.verification || {};
      if (stepFilter === 'email' && verification.email) return false;
      if (stepFilter === 'phone' && verification.phone) return false;
      if (stepFilter === 'address' && verification.address?.verified) return false;
      if (stepFilter === 'cnic' && verification.cnic?.verified) return false;
      if (stepFilter === 'selfie' && verification.selfie?.verified) return false;
      if (stepFilter === 'shop' && verification.shop?.verified) return false;
    }
    
    // Search filter
    if (searchTerm) {
      const searchableText = `${user.displayName || ''} ${user.email || ''} ${user.id}`.toLowerCase();
      if (!searchableText.includes(searchTerm)) return false;
    }
    
    return true;
  });
  
  renderUsers();
}

// User selection functionality
$('selectAllCheckbox').addEventListener('change', (e) => {
  const isChecked = e.target.checked;
  const checkboxes = document.querySelectorAll('.user-checkbox');
  
  checkboxes.forEach(checkbox => {
    checkbox.checked = isChecked;
    if (isChecked) {
      selectedUsers.add(checkbox.value);
    } else {
      selectedUsers.delete(checkbox.value);
    }
  });
  
  updateBulkActions();
});

document.addEventListener('change', (e) => {
  if (e.target.classList.contains('user-checkbox')) {
    if (e.target.checked) {
      selectedUsers.add(e.target.value);
    } else {
      selectedUsers.delete(e.target.value);
    }
    updateBulkActions();
  }
});

function updateBulkActions() {
  const hasSelection = selectedUsers.size > 0;
  $('bulkApproveBtn').disabled = !hasSelection;
  $('bulkRejectBtn').disabled = !hasSelection;
}

// User actions
async function approveUser(userId) {
  try {
    await db.collection('users').doc(userId).update({
      status: 'verified',
      verifiedAt: firebase.firestore.FieldValue.serverTimestamp()
    });
    
    showSuccess('User approved successfully!');
    await loadUsers();
    loadStats();
  } catch (error) {
    showError('Failed to approve user. Please try again.');
  }
}

async function rejectUser(userId) {
  const reason = prompt('Reason for rejection (optional):');
  
  try {
    await db.collection('users').doc(userId).update({
      status: 'rejected',
      rejectionReason: reason || null,
      rejectedAt: firebase.firestore.FieldValue.serverTimestamp()
    });
    
    showSuccess('User rejected successfully!');
    await loadUsers();
    loadStats();
  } catch (error) {
    showError('Failed to reject user. Please try again.');
  }
}

async function viewVerification(userId) {
  const user = allUsers.find(u => u.id === userId);
  if (!user) return;
  
  const modal = $('verificationModal');
  const content = $('verificationContent');
  
  content.innerHTML = `
    <div class="verification-details">
      <div class="user-header">
        <h4>${user.displayName || 'Unknown User'}</h4>
        <p>${user.email || user.id}</p>
        <span class="role-badge ${user.role?.toLowerCase() || 'buyer'}">${user.role || 'Buyer'}</span>
      </div>
      
      <div class="verification-sections">
        <div class="verification-section">
          <h5>Personal Information</h5>
          <div class="info-grid">
            <div class="info-item">
              <label>Full Name:</label>
              <span>${user.displayName || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>Email:</label>
              <span>${user.email || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>Phone:</label>
              <span>${user.phone || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>Date of Birth:</label>
              <span>${user.dateOfBirth || 'Not provided'}</span>
            </div>
          </div>
        </div>
        
        <div class="verification-section">
          <h5>Address Information</h5>
          <div class="info-grid">
            <div class="info-item">
              <label>Street Address:</label>
              <span>${user.address?.street || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>City:</label>
              <span>${user.address?.city || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>State:</label>
              <span>${user.address?.state || 'Not provided'}</span>
            </div>
            <div class="info-item">
              <label>Postal Code:</label>
              <span>${user.address?.postalCode || 'Not provided'}</span>
            </div>
          </div>
        </div>
        
        <div class="verification-section">
          <h5>Documents</h5>
          <div class="document-grid">
            ${getDocumentPreview(user.verification)}
          </div>
        </div>
      </div>
      
      <div class="verification-actions">
        <button class="btn success" onclick="approveUser('${userId}'); closeVerificationModal();">Approve</button>
        <button class="btn danger" onclick="rejectUser('${userId}'); closeVerificationModal();">Reject</button>
        <button class="btn secondary" onclick="closeVerificationModal();">Close</button>
      </div>
    </div>
  `;
  
  modal.classList.add('show');
}

function getDocumentPreview(verification) {
  const docs = [];
  
  if (verification?.cnic?.frontUrl) {
    docs.push(`
      <div class="document-item">
        <h6>CNIC Front</h6>
        <img src="${verification.cnic.frontUrl}" alt="CNIC Front" class="document-image">
        <a href="${verification.cnic.frontUrl}" target="_blank" class="btn small">View Full Size</a>
      </div>
    `);
  }
  
  if (verification?.cnic?.backUrl) {
    docs.push(`
      <div class="document-item">
        <h6>CNIC Back</h6>
        <img src="${verification.cnic.backUrl}" alt="CNIC Back" class="document-image">
        <a href="${verification.cnic.backUrl}" target="_blank" class="btn small">View Full Size</a>
      </div>
    `);
  }
  
  if (verification?.selfie?.url) {
    docs.push(`
      <div class="document-item">
        <h6>Selfie</h6>
        <img src="${verification.selfie.url}" alt="Selfie" class="document-image">
        <a href="${verification.selfie.url}" target="_blank" class="btn small">View Full Size</a>
      </div>
    `);
  }
  
  return docs.length > 0 ? docs.join('') : '<p>No documents uploaded</p>';
}

function closeVerificationModal() {
  $('verificationModal').classList.remove('show');
}

// Bulk actions
$('bulkApproveBtn').addEventListener('click', async () => {
  if (selectedUsers.size === 0) return;
  
  if (!confirm(`Approve ${selectedUsers.size} users?`)) return;
  
  try {
    const batch = db.batch();
    selectedUsers.forEach(userId => {
      const userRef = db.collection('users').doc(userId);
      batch.update(userRef, {
        status: 'verified',
        verifiedAt: firebase.firestore.FieldValue.serverTimestamp()
      });
    });
    
    await batch.commit();
    showSuccess(`${selectedUsers.size} users approved successfully!`);
    selectedUsers.clear();
    await loadUsers();
    loadStats();
  } catch (error) {
    showError('Failed to approve users. Please try again.');
  }
});

$('bulkRejectBtn').addEventListener('click', async () => {
  if (selectedUsers.size === 0) return;
  
  const reason = prompt('Reason for rejection (optional):');
  if (!confirm(`Reject ${selectedUsers.size} users?`)) return;
  
  try {
    const batch = db.batch();
    selectedUsers.forEach(userId => {
      const userRef = db.collection('users').doc(userId);
      batch.update(userRef, {
        status: 'rejected',
        rejectionReason: reason || null,
        rejectedAt: firebase.firestore.FieldValue.serverTimestamp()
      });
    });
    
    await batch.commit();
    showSuccess(`${selectedUsers.size} users rejected successfully!`);
    selectedUsers.clear();
    await loadUsers();
    loadStats();
  } catch (error) {
    showError('Failed to reject users. Please try again.');
  }
});

// Admin promotion
$('promoteBtn').addEventListener('click', async () => {
  const email = $('newAdminEmail').value.trim();
  if (!email) return;
  
  try {
    await firebase.functions().httpsCallable('setAdminByEmail')({ email });
    showSuccess('Admin privileges granted. User must re-login for changes to apply.');
    $('newAdminEmail').value = '';
  } catch (err) {
    showError('Failed to promote user. Please try again.');
  }
});

// User suspension
$('suspendBtn').addEventListener('click', async () => {
  const email = $('suspendEmail').value.trim();
  if (!email) return;
  
  if (!confirm(`Suspend user with email: ${email}?`)) return;
  
  try {
    const userQuery = await db.collection('users').where('email', '==', email).get();
    if (userQuery.empty) {
      showError('User not found.');
      return;
    }
    
    const userDoc = userQuery.docs[0];
    await userDoc.ref.update({
      isSuspended: true,
      suspendedAt: firebase.firestore.FieldValue.serverTimestamp()
    });
    
    showSuccess('User suspended successfully!');
    $('suspendEmail').value = '';
    await loadUsers();
    loadStats();
  } catch (error) {
    showError('Failed to suspend user. Please try again.');
  }
});

// Utility functions
function showSuccess(message) {
  showNotification(message, 'success');
}

function showError(message) {
  showNotification(message, 'error');
}

function showNotification(message, type) {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 20px;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    z-index: 1000;
    background: ${type === 'success' ? '#10b981' : '#ef4444'};
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    if (notification.parentNode) notification.remove();
  }, 3000);
}
</script>

<style>
/* Enhanced Admin Panel Styles */
.page-admin {
  background: #f8fafc;
  min-height: 100vh;
}

.admin-header {
  background: linear-gradient(135deg, #1e293b, #334155);
  color: white;
  padding: 32px;
  border-radius: 20px;
  margin-bottom: 32px;
}

.admin-header h1 {
  margin: 0 0 24px;
  font-size: 32px;
  font-weight: 800;
}

.admin-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 24px;
}

.stat-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 20px;
  border-radius: 12px;
  text-align: center;
  backdrop-filter: blur(10px);
}

.stat-value {
  font-size: 32px;
  font-weight: 800;
  margin-bottom: 8px;
}

.stat-label {
  font-size: 14px;
  opacity: 0.9;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.admin-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 24px;
  margin-bottom: 32px;
}

.action-card {
  background: white;
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(16, 24, 40, 0.08);
  border: 1px solid #e2e8f0;
}

.action-card h3 {
  margin: 0 0 20px;
  font-size: 18px;
  font-weight: 700;
  color: #1e293b;
}

.form-row {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
}

.form-row input {
  flex: 1;
  padding: 12px 16px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
}

.form-row input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.bulk-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.filters-card {
  background: white;
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(16, 24, 40, 0.08);
  border: 1px solid #e2e8f0;
  margin-bottom: 32px;
}

.filters-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.filter-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.filter-group label {
  font-weight: 600;
  color: #374151;
  font-size: 14px;
}

.filter-group select,
.filter-group input {
  padding: 12px 16px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
}

.filter-group select:focus,
.filter-group input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.users-table-card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(16, 24, 40, 0.08);
  border: 1px solid #e2e8f0;
  overflow: hidden;
}

.table-header {
  padding: 24px;
  border-bottom: 1px solid #e2e8f0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.table-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: #1e293b;
}

.table-actions {
  display: flex;
  gap: 12px;
}

.table-container {
  overflow-x: auto;
}

.users-table {
  width: 100%;
  border-collapse: collapse;
}

.users-table th {
  background: #f8fafc;
  padding: 16px;
  text-align: left;
  font-weight: 600;
  color: #374151;
  border-bottom: 1px solid #e2e8f0;
  font-size: 14px;
}

.users-table td {
  padding: 16px;
  border-bottom: 1px solid #f1f5f9;
  vertical-align: top;
}

.users-table tr:hover {
  background: #f8fafc;
}

.user-info {
  min-width: 200px;
}

.user-name {
  font-weight: 600;
  color: #1e293b;
  margin-bottom: 4px;
}

.user-email {
  color: #64748b;
  font-size: 14px;
  margin-bottom: 4px;
}

.user-joined {
  color: #9ca3af;
  font-size: 12px;
}

.role-badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.role-badge.buyer {
  background: #dbeafe;
  color: #1e40af;
}

.role-badge.seller {
  background: #dcfce7;
  color: #166534;
}

.status-badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.status-badge.pending {
  background: #fef3c7;
  color: #92400e;
}

.status-badge.verified {
  background: #d1fae5;
  color: #065f46;
}

.status-badge.suspended {
  background: #fecaca;
  color: #991b1b;
}

.status-badge.inactive {
  background: #e5e7eb;
  color: #6b7280;
}

.progress-bar {
  position: relative;
  background: #e5e7eb;
  border-radius: 10px;
  height: 8px;
  margin-bottom: 8px;
  overflow: hidden;
}

.progress-fill {
  background: linear-gradient(90deg, #3b82f6, #1d4ed8);
  height: 100%;
  border-radius: 10px;
  transition: width 0.3s ease;
}

.progress-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 10px;
  font-weight: 600;
  color: white;
}

.progress-steps {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.progress-step {
  font-size: 10px;
  color: #6b7280;
}

.progress-step.completed {
  color: #059669;
}

.document-links {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.doc-link {
  color: #3b82f6;
  text-decoration: none;
  font-size: 12px;
  font-weight: 500;
}

.doc-link:hover {
  text-decoration: underline;
}

.no-docs {
  color: #9ca3af;
  font-size: 12px;
  font-style: italic;
}

.action-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.btn {
  padding: 8px 16px;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  font-size: 12px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn.primary {
  background: #3b82f6;
  color: white;
}

.btn.primary:hover {
  background: #2563eb;
}

.btn.secondary {
  background: #f8fafc;
  color: #374151;
  border: 1px solid #e2e8f0;
}

.btn.secondary:hover {
  background: #f1f5f9;
}

.btn.success {
  background: #10b981;
  color: white;
}

.btn.success:hover {
  background: #059669;
}

.btn.danger {
  background: #ef4444;
  color: white;
}

.btn.danger:hover {
  background: #dc2626;
}

.btn.small {
  padding: 6px 12px;
  font-size: 11px;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Modal Styles */
.modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal.show {
  display: flex;
}

.modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
}

.modal-panel {
  position: relative;
  background: white;
  border-radius: 16px;
  box-shadow: 0 25px 50px rgba(16, 24, 40, 0.15);
  width: min(800px, 90vw);
  max-height: 90vh;
  overflow-y: auto;
}

.modal-header {
  padding: 24px 24px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h3 {
  margin: 0;
  font-size: 20px;
  font-weight: 700;
  color: #1e293b;
}

.close-btn {
  background: none;
  border: none;
  font-size: 24px;
  color: #6b7280;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-btn:hover {
  color: #374151;
}

.modal-content {
  padding: 24px;
}

.verification-details {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.user-header {
  text-align: center;
  padding-bottom: 20px;
  border-bottom: 1px solid #e2e8f0;
}

.user-header h4 {
  margin: 0 0 8px;
  font-size: 24px;
  font-weight: 700;
  color: #1e293b;
}

.user-header p {
  margin: 0 0 12px;
  color: #64748b;
}

.verification-sections {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.verification-section h5 {
  margin: 0 0 16px;
  font-size: 16px;
  font-weight: 600;
  color: #1e293b;
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
}

.info-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.info-item label {
  font-weight: 600;
  color: #374151;
  font-size: 14px;
}

.info-item span {
  color: #64748b;
  font-size: 14px;
}

.document-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
}

.document-item {
  text-align: center;
  padding: 16px;
  background: #f8fafc;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.document-item h6 {
  margin: 0 0 12px;
  font-size: 14px;
  font-weight: 600;
  color: #1e293b;
}

.document-image {
  width: 100%;
  height: 120px;
  object-fit: cover;
  border-radius: 6px;
  margin-bottom: 12px;
}

.verification-actions {
  display: flex;
  gap: 12px;
  justify-content: center;
  padding-top: 20px;
  border-top: 1px solid #e2e8f0;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 40px 20px;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.empty-text {
  color: #64748b;
  margin-bottom: 20px;
}

/* Loading Skeleton */
.loading-skeleton {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.skeleton-line {
  height: 20px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: 4px;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Responsive */
@media (max-width: 768px) {
  .admin-stats {
    grid-template-columns: repeat(2, 1fr);
  }

  .admin-actions {
    grid-template-columns: 1fr;
  }

  .filters-row {
    grid-template-columns: 1fr;
  }

  .table-actions {
    flex-direction: column;
  }

  .action-buttons {
    flex-direction: column;
  }

  .verification-actions {
    flex-direction: column;
  }

  .info-grid {
    grid-template-columns: 1fr;
  }

  .document-grid {
    grid-template-columns: 1fr;
  }
}
</style>
</body>
</html>
